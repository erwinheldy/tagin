!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.t?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).Tagin=i()}(this,function(){"use strict";class Tagin{i="tagin";h="tagin-wrapper";o="tagin-tag";u="tagin-tag-remove";p="tagin-input";l="tagin-input-hidden";target;g;input;separator;placeholder;duplicate;transform;v;constructor(t,i){this.target=t,this.separator=i?.separator||t.dataset.m||",",this.placeholder=i?.placeholder||t.dataset.T||"",this.duplicate=i?.duplicate||void 0!==t.dataset.k,this.transform=i?.transform||t.dataset.$||"input => input",this.v=i?.v||void 0!==t.dataset.H,this.I(),this.L(),this.addEventListener()}I(){var t=""===this.M()?"":this.getValues().map(t=>this.V(t)).join("");const i=document.createElement("input");i.type="text",i.className=this.p,i.placeholder=this.placeholder;const s=document.createElement("div");s.className=this.h+" "+this.target.className,s.classList.remove(this.i),s.insertAdjacentHTML("afterbegin",t),s.insertAdjacentElement("beforeend",i),this.target.insertAdjacentElement("afterend",s),this.g=s,this.input=i}V(t){return`<span class="${this.o}">${t}<span onclick="this.closest('div').dispatchEvent(new CustomEvent('tagin:remove', { detail: this }))" class="${this.u}"></span></span>`}M(){return this.target.value.trim()}getValues(){return this.M().split(this.separator)}getTags(){return Array.from(this.g.getElementsByClassName(this.o)).map(t=>t.textContent)}A(){return this.getTags().join(this.separator)}S(){this.target.value=this.A(),this.target.dispatchEvent(new Event("change"))}L(){const t=document.createElement("div");t.classList.add(this.p,this.l);const i=this.input.value||this.input.placeholder||"";t.innerHTML=i.replace(/ /g,"&nbsp;"),document.body.appendChild(t),this.input.style.setProperty("width",Math.ceil(parseInt(window.getComputedStyle(t).width.replace("px","")))+1+"px"),t.remove()}addEventListener(){const i=this.g,s=this.input;i.addEventListener("click",()=>s.focus()),s.addEventListener("focus",()=>i.classList.add("focus")),s.addEventListener("blur",()=>i.classList.remove("focus")),s.addEventListener("input",()=>{this.W(),this.L()}),s.addEventListener("blur",()=>{this.W(!0),this.L()}),s.addEventListener("keydown",t=>{""===s.value&&"Backspace"===t.key&&i.getElementsByClassName(this.o).length&&(i.querySelector(`.${this.o}:last-of-type`).remove(),this.S()),""!==s.value&&"Enter"===t.key&&this.v&&(this.W(!0),this.L(),t.preventDefault())}),i.addEventListener("tagin:remove",t=>{t.detail instanceof HTMLSpanElement&&(t.detail.parentElement.remove(),this.S())}),this.target.addEventListener("change",()=>this.j())}W(force=!1){const input=this.input,value=eval(this.transform)(input.value.trim());""===value&&(input.value=""),(input.value.includes(this.separator)||force&&""!==input.value)&&(value.split(this.separator).filter(t=>""!==t).forEach(t=>{this.getTags().includes(t)&&!1===this.duplicate?this.B(t):(input.insertAdjacentHTML("beforebegin",this.V(t)),this.S())}),input.value="",input.removeAttribute("style"))}B(t){for(const i of this.g.getElementsByClassName(this.o))i.textContent===t&&i instanceof HTMLSpanElement&&(i.style.transform="scale(1.09)",setTimeout(()=>{i.removeAttribute("style")},150))}j(){this.M()!==this.A()&&([...this.g.getElementsByClassName(this.o)].map(t=>t.remove()),""!==this.M().trim()&&this.input.insertAdjacentHTML("beforebegin",this.getValues().map(t=>this.V(t)).join("")))}C(t){this.input.value=(Array.isArray(t)?t.join(this.separator):t)+this.separator,this.input.dispatchEvent(new Event("input"))}}return Tagin});