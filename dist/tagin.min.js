!function(t,i){"object"==typeof exports&&"undefined"!=typeof module?module.exports=i():"function"==typeof define&&define.t?define(i):(t="undefined"!=typeof globalThis?globalThis:t||self).i=i()}(this,function(){"use strict";class Tagin{h="tagin";o="tagin-wrapper";u="tagin-tag";p="tagin-tag-remove";l="tagin-input";g="tagin-input-hidden";target;v;input;separator;placeholder;duplicate;transform;m;constructor(t,i){this.target=t,this.separator=i?.separator||t.dataset.T||",",this.placeholder=i?.placeholder||t.dataset.k||"",this.duplicate=i?.duplicate||void 0!==t.dataset.$,this.transform=i?.transform||t.dataset.H||"input => input",this.m=i?.m||void 0!==t.dataset.I,this.L(),this.M(),this.addEventListener()}L(){var t=""===this.V()?"":this.getValues().map(t=>this.A(t)).join("");const i=document.createElement("input");i.type="text",i.className=this.l,i.placeholder=this.placeholder;const s=document.createElement("div");s.className=this.o+" "+this.target.className,s.classList.remove(this.h),s.insertAdjacentHTML("afterbegin",t),s.insertAdjacentElement("beforeend",i),this.target.insertAdjacentElement("afterend",s),this.v=s,this.input=i}A(t){return`<span class="${this.u}">${t}<span onclick="this.closest('div').dispatchEvent(new CustomEvent('tagin:remove', { detail: this }))" class="${this.p}"></span></span>`}V(){return this.target.value.trim()}getValues(){return this.V().split(this.separator)}getTags(){return Array.from(this.v.getElementsByClassName(this.u)).map(t=>t.textContent)}S(){return this.getTags().join(this.separator)}W(){this.target.value=this.S(),this.target.dispatchEvent(new Event("change"))}M(){const t=document.createElement("div");t.classList.add(this.l,this.g);const i=this.input.value||this.input.placeholder||"";t.innerHTML=i.replace(/ /g,"&nbsp;"),document.body.appendChild(t),this.input.style.setProperty("width",Math.ceil(parseInt(window.getComputedStyle(t).width.replace("px","")))+1+"px"),t.remove()}addEventListener(){const i=this.v,s=this.input;i.addEventListener("click",()=>s.focus()),s.addEventListener("focus",()=>i.classList.add("focus")),s.addEventListener("blur",()=>i.classList.remove("focus")),s.addEventListener("input",()=>{this.j(),this.M()}),s.addEventListener("blur",()=>{this.j(!0),this.M()}),s.addEventListener("keydown",t=>{""===s.value&&"Backspace"===t.key&&i.getElementsByClassName(this.u).length&&(i.querySelector(`.${this.u}:last-of-type`).remove(),this.W()),""!==s.value&&"Enter"===t.key&&this.m&&(this.j(!0),this.M(),t.preventDefault())}),i.addEventListener("tagin:remove",t=>{t.detail instanceof HTMLSpanElement&&(t.detail.parentElement.remove(),this.W())}),this.target.addEventListener("change",()=>this.B())}j(force=!1){const input=this.input,value=eval(this.transform)(input.value.trim());""===value&&(input.value=""),(input.value.includes(this.separator)||force&&""!==input.value)&&(value.split(this.separator).filter(t=>""!==t).forEach(t=>{this.getTags().includes(t)&&!1===this.duplicate?this.C(t):(input.insertAdjacentHTML("beforebegin",this.A(t)),this.W())}),input.value="",input.removeAttribute("style"))}C(t){for(const i of this.v.getElementsByClassName(this.u))i.textContent===t&&i instanceof HTMLSpanElement&&(i.style.transform="scale(1.09)",setTimeout(()=>{i.removeAttribute("style")},150))}B(){this.V()!==this.S()&&([...this.v.getElementsByClassName(this.u)].map(t=>t.remove()),""!==this.V().trim()&&this.input.insertAdjacentHTML("beforebegin",this.getValues().map(t=>this.A(t)).join("")))}R(t){this.input.value=(Array.isArray(t)?t.join(this.separator):t)+this.separator,this.input.dispatchEvent(new Event("input"))}}return Tagin});